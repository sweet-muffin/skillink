FROM python:3.9

ARG MYSQL_HOST
ARG MYSQL_USER
ARG MYSQL_PASSWORD
ARG MYSQL_DB
ARG MYSQL_CHARSET
ARG OPENAI_API_KEY
ARG OPENAI_API_ORG
ARG WANTED_ENDPOINT
ARG WANTED_ID
ARG WANTED_SECRET

ENV MYSQL_HOST ${MYSQL_HOST}
ENV MYSQL_USER ${MYSQL_USER}
ENV MYSQL_PASSWORD ${MYSQL_PASSWORD}
ENV MYSQL_DB ${MYSQL_DB}
ENV MYSQL_CHARSET ${MYSQL_CHARSET}
ENV OPENAI_API_KEY ${OPENAI_API_KEY}
ENV OPENAI_API_ORG ${OPENAI_API_ORG}
ENV WANTED_ENDPOINT ${WANTED_ENDPOINT}
ENV WANTED_ID ${WANTED_ID}
ENV WANTED_SECRET ${WANTED_SECRET}

COPY . /app
WORKDIR /app

RUN pip install -r requirements.txt

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8080"]